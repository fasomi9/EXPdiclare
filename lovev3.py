# scope: hikka_only
# scope: hikka_min 1.5.3

import asyncio
import logging
import random
import time

from telethon.tl.types import Message

from .. import loader, utils
from ..inline.types import BotMessage

logger = logging.getLogger(__name__)


@loader.tds
class decllove(loader.Module):
    """If you are too humble to declare your love, use this module"""

    
    strings_ru = {
        "name": "Lover",
        "not_private": (
            "<emoji document_id=6053166094816905153>üíÄ</emoji> <b>–≠—Ç—É –∫–æ–º–∞–Ω–¥—É –Ω—É–∂–Ω–æ"
            " –≤—ã–ø–æ–ª–Ω—è—Ç—å –≤ –ª–∏—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏—è—Ö...</b>"
        ),
        "ily": (
            "<emoji document_id=5465143921912846619>üí≠</emoji> <b>–£ –≤–∞—Å 1 –Ω–æ–≤–æ–µ"
            ' —Å–æ–æ–±—â–µ–Ω–∏–µ. <a href="https://t.me/{}?start=read_{}">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–æ—á—Ç–∏—Ç–µ'
            " –µ–≥–æ</a></b>"
        ),
        "ily_love": [
            "üëã <i>–ü—Ä–∏–≤–µ—Ç. –Ø <b>—Å—Ç—Ä–∞–∂ –æ—á–µ–Ω—å —Ç–æ–∫—Å–∏—á–Ω–æ–≥–æ –¥–æ–ª–±–∞–µ–±–∞</b>.</i>",
            (
                "ü´£ <i>–ú–æ–π —Ö–æ–∑—è–∏–Ω –¥—É—Ä–∞–∫ —Ç–æ—Ç –µ—â—ë, –∏ –æ—á–µ–Ω—å —Å—Ç–µ—Å–Ω—è–µ—Ç—Å—è —Å–∫–∞–∑–∞—Ç—å –æ —á–µ–º-—Ç–æ, –ø–æ—ç—Ç–æ–º—É –æ–Ω"
                " –ø–æ–ø—Ä–æ—Å–∏–ª –º–µ–Ω—è, —Å–≤–æ–µ —Ç–≤–æ—Ä–µ–Ω–∏–µ, –ø–æ–º–æ—á—å –µ–º—É... –Ω–æ –ø—Ä–∏–¥–µ—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫–æ–º,–ø–æ—Ä–æ–π –ø—Ä–∏–¥–µ—Ç—Å—è –ø–µ—Ä–µ–≤–æ–¥–∏—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ç–µ–∫—Å—Ç, –≤—ã –ø—Ä–æ—Å—Ç–∏—Ç–µ –µ–≥–æ, –≤–µ–¥—å –æ–Ω –æ—á–µ–Ω—å —Å—Ç–µ—Å–Ω–∏—Ç–µ–ª–µ–Ω...</i>"
            ),
            "ü•∞ <i>–û–Ω –ø—Ä–æ—Å—Ç–æ —Ö–æ—Ç–µ–ª, —á—Ç–æ–±—ã –≤—ã –∑–Ω–∞–ª–∏, –ß–¢–û <b> il vous aime –∏ —Å–∏–ª—å–Ω–æ —Ü–µ–Ω–∏—Ç –Ω–µ –∑–∞ –≤–Ω–µ—à–Ω–∏–π –≤–∏–¥,–∞ –∑–∞ –≤–∞—à–µ –æ–±—â–µ–Ω–∏–µ –∏ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –∫ –Ω–µ–º—É, –∏ –æ–Ω –ø—Ä–æ—Å–∏–ª –ø–µ—Ä–µ–¥–∞—Ç—å, —á—Ç–æ –æ–Ω —Ö–æ—á–µ—Ç —Å –≤–∞–º–∏ –ø—Ä–æ–≤–æ–¥–∏—Ç—å –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏, –≤–µ–¥—å –µ–º—É –Ω—Ä–∞–≤–∏—Ç—Å—è –ø—Ä–æ–≤–æ–¥–∏—Ç—å —Å –≤–∞–º–∏ –≤—Ä–µ–º—è</b>...</i>",
            "ü§ó <i>–Ω–µ –ø–ª–∞—á—å—Ç–µ, —Å–æ–ª–Ω—Ü–µ, –Ω–æ –µ—Å–ª–∏ –≤—Å–µ –∂–µ –≤—ã –ø–ª–∞—á–µ—Ç–µ, —Ç–æ —Å–∫–∞–∂–∏—Ç–µ –µ–º—É –æ–± —ç—Ç–æ–º, –æ–Ω –ø–æ—Å—Ç–∞—Ä–∞–µ—Ç—Å—è –ø–æ–¥–¥–µ—Ä–∂–∞—Ç—å –≤–∞—Å... —Å–∫–∞–∂—É —è –≤–∞–º –æ–¥–Ω–æ <b> mon √¢me s'est √©panouie comme la plus belle fleur √† c√¥t√© de toi.</b>merci beaucoup...</i>",
            "<i>—á–∏—Ç–∞–π—Ç–µ,–∫–æ–≥–¥–∞ —Ç–µ–±–µ –±—É–¥–µ—Ç –≥—Ä—É—Å—Ç–Ω–æ –∏ –ø–ª–æ—Ö–æ.<br> –û–ù –õ–Æ–ë–ò–¢ –í–ê–° –ò –°–ò–õ–¨–ù–û –°–ö–£–ß–ê–ï–¢<br> –ï–ú–£ –ù–ï –•–í–ê–¢–ê–ï–¢ –í–ê–°, –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç –≤–∞—à–∏—Ö –º–∏–ª—ã—Ö —Ä–∞–∑–≥–æ–≤–æ—Ä–æ–≤, –≤–∞—à–µ–π –º–∏–ª–æ–π —É–ª—ã–±–∫–∏ —Ä—è–¥–æ–º, –≤–∞—à–∏—Ö –∫—Ä–∞—Å–∏–≤—ã—Ö –≥–ª–∞–∑–æ–∫.<br> –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç —Ç–∞–∫ –∂–µ –æ–±—ä—è—Ç–∏–π —Ç–µ–ø–ª—ã—Ö,–∫–æ—Ç–æ—Ä—ã–µ –≥—Ä–µ—é—Ç –Ω–µ —Ç–æ–ª—å–∫–æ —Ç–µ–ª–æ, –Ω–æ –∏ –¥—É—à—É</i>",
            "‚ù§Ô∏è<i><b>—Ö–æ—á–µ—à—å —Ä–∞—Å—Å–∫–∞–∂—É –∫–∞–∫ —Ç—ã –≤—ã–≥–ª—è–¥–∏—à—å –≤ –µ–≥–æ –≥–ª–∞–∑–∞—Ö?
–Ω–µ–º–Ω–æ–≥–æ –Ω–∏–∂–µ –µ–≥–æ, –Ω–æ –≥–ª–∞–∑–∞ —Ç–∞–∫ –∏ –º–∞–Ω—è—Ç —É—Ç–æ–Ω—É—Ç—å –≤ –Ω–∏—Ö , –∫–∞–∫ –≤ –±–µ—Å–∫—Ä–∞–π–Ω–µ–º –∫–æ—Å–º–æ—Å–µ, —Ü–≤–µ—Ç–∞ –Ω–µ–º–Ω–æ–≥–æ —Ç–µ–º–Ω–æ–π –≥—Ä—É—Å—Ç–∏, –Ω–æ —Ç–∞–º —É—Ç–æ–Ω—É–ª –æ–Ω –Ω–∞–≤—Å–µ–≥–¥–∞.
–≤–æ–ª–æ—Å—ã —Ç–≤–æ–∏ —Ç–∞–∫ –ø—Ä–∏—è—Ç–Ω—ã, –∞ —Ä—É–∫–∏ —Ç–∞–∫ –Ω–µ–∂–Ω—ã.<br> –Ω–µ—Ç –Ω–∏—á–µ–≥–æ —Ç–µ–ø–ª–µ–µ —Ç–≤–æ–∏—Ö –æ–±—ä—è—Ç–∏–π, –Ω–µ—Ç –Ω–∏—á–µ–≥–æ –æ —á–µ–º –æ–Ω –¥—É–º–∞–µ—Ç –±–æ–ª—å—à–µ, —á–µ–º –æ —Ç–µ–±–µ.</b></i>",
            "<i>senorita, tu es belle comme le premier paysage matinal dans une nature dense, comme un chaud rayon de soleil par une journ√©e froide et maussade.
En te voyant j'admire, j'admire ton sourire, tes yeux et ta beaut√©</i>",
            "ü•∫ <i>–≠—Ç–æ –∏—Å–∫—Ä–µ–Ω–Ω–∏–µ —á—É–≤—Å—Ç–≤–∞ –∫ –≤–∞–º –∏ —Å–ª–æ–≤–∞, –º–∏–ª–∞—è –ª–µ–¥–∏... –ø–æ—ç—Ç–æ–º—É –ø—Ä–æ—à—É –ø—Ä–∏–Ω—è—Ç—å —ç—Ç–æ –∫ —Å–≤–µ–¥–µ–Ω–∏—é –∏ –Ω–µ —Å–∏–ª—å–Ω–æ –∑–ª–∏—Ç—å—Å—è –Ω–∞ –Ω–µ–≥–æ –∑–∞ –µ–≥–æ —Å—Ç–µ—Å–Ω–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –∫–æ—Ç–æ—Ä—É—é –æ–Ω –Ω–µ –º–æ–∂–µ—Ç –ø–æ–±–æ—Ä–æ—Ç—å.</i>",
            "ü´∂ <i>—Å–∫–∞–∂—É –ø–æ —Å–µ–∫—Ä–µ—Ç—É –º–∞–ª–µ–Ω—å–∫–æ–º—É <b>tu lui manques</b> </i>",
            "ü´∞ <i>–ª—É—á—à–µ –Ω–∏—á–µ–≥–æ –µ–º—É –Ω–µ –≥–æ–≤–æ—Ä–∏—Ç—å –æ –Ω–∞—à–µ–º –¥–∏–∞–ª–æ–≥–µ —Å –≤–∞–º–∏,–Ω–æ –Ω–µ –∏–º–µ—é –ø—Ä–∞–≤–∞ –≤–∞–º –∑–∞–ø—Ä–µ—â–∞—Ç—å, –∏ –µ—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –æ–±—Å—É–¥–∏—Ç—å —ç—Ç–æ—Ç –¥–∏–∞–ª–æ–≥, —Ç–æ —Ö–æ—Ä–æ—à–æ. –º–æ–π —Å–æ–≤–µ—Ç: —Å–∫–∞–∑–∞—Ç—å –ø–∞—Ä—É –ª–∞—Å–∫–æ–≤—ã—Ö —Å–ª–æ–≤–µ—á–µ–∫. –≤–∞—à –ª—é–±–∏–º—ã–π Bl00DBot.üôÇ</i>",

        ],
        "talk": "ü´∂ –ø–æ–≥–æ–≤–æ—Ä–∏—Ç—å",
        "404": "üò¢ <b>–°–æ–æ–±—â–µ–Ω–∏–µ —É–∂–µ –∏—Å—á–µ–∑–ª–æ. –í—ã –Ω–µ –º–æ–∂–µ—Ç–µ –µ–≥–æ –ø—Ä–æ—á–∏—Ç–∞—Ç—å...</b>",
        "read": "ü´∞ <b>{} –±—Ä–∞—Ç,–ø—Ä–æ—Å—Ç–∏,—è —Å–ø–∞–ª–∏–ª —Ç–µ–±—è, –Ω–æ —Ç–µ–±–µ –æ—Ç —ç—Ç–æ–≥–æ –±—É–¥–µ—à—å –ª—É—á—à–µ, —è —Å—Ç–∞—Ä–∞—é—Å—å –¥–ª—è —Ç–µ–±—è —Ä–æ–¥–Ω–æ–π –º–æ–π.</b>",
        "args": (
            "<emoji document_id=6053166094816905153>üíÄ</emoji> <b>–ù–µ–≤–µ—Ä–Ω—ã–µ"
            " –∞—Ä–≥—É–º–µ–Ω—Ç—ã...</b>"
        ),
    }


    async def client_ready(self):
        self.ids = self.pointer("lover", {})

    @loader.command(ru_doc="–ü—Ä–∏–∑–Ω–∞—Ç—å—Å—è –≤ –ª—é–±–≤–∏")
    async def decl(self, message: Message):
        """Declare love"""
        if not message.is_private:
            await utils.answer(message, self.strings("not_private"))
            return

        id_ = utils.rand(8)
        await utils.answer(
            message,
            self.strings("ily").format(self.inline.bot_username, id_),
        )
        self.ids[id_] = int(time.time()) + 24 * 60 * 60

    async def aiogram_watcher(self, message: BotMessage):
        if not message.text.startswith("/start read_"):
            return

        for id_, info in self.ids.copy().items():
            if info < int(time.time()):
                self.ids.pop(id_)
                continue

        id_ = message.text.split("_")[1]
        if id_ not in self.ids:
            await message.answer(self.strings("404"))
            return

        info = self.ids.pop(id_)
        for m in self.strings("ily_love")[:-1]:
            await message.answer(m)
            await asyncio.sleep(random.randint(350, 400) / 100)

        await self.inline.bot.send_message(
            self._client.tg_id,
            self.strings("read").format(
                utils.escape_html(message.from_user.full_name),
            ),
        )


        await message.answer(
            self.strings("ily_love")[-1],
            reply_markup=self.inline.generate_markup(
                {
                    "text": self.strings("talk"),
                    "url": f"tg://user?id={self._client.tg_id}",
                }
            ),
        )


      
